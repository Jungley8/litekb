# LiteKB 项目状态报告

## 📊 当前进度

| 项目 | 数量 |
|------|------|
| 提交次数 | 10 次 |
| 后端服务 | 11 个 |
| 前端组件 | 6 个 |
| 待办标记 | 26 个 |

---

## ⚠️ 遗留问题

### 1. 认证与权限
| 问题 | 严重度 | 说明 |
|------|--------|------|
| Token 权限不足 | 🔴 | `workflow` 权限缺失，无法推送 CI/CD |
| JWT Token 刷新 | 🟡 | 未实现 refresh token 机制 |
| 密码重置 | 🟡 | 未实现忘记密码功能 |
| OAuth 登录 | 🟢 | Google/GitHub 登录未实现 |

### 2. 数据库
| 问题 | 严重度 | 说明 |
|------|--------|------|
| 迁移工具 | 🔴 | 缺少 Alembic 迁移脚本 |
| 索引优化 | 🟡 | 未添加数据库索引 |
| 软删除 | 🟢 | 未实现软删除机制 |

### 3. 核心功能
| 问题 | 严重度 | 说明 |
|------|--------|------|
| PDF OCR | 🔴 | 扫描版 PDF 无法解析 |
| 增量索引 | 🟡 | 更新文档需全量重建索引 |
| 图谱 Neo4j | 🟡 | 当前使用内存图谱，未集成 Neo4j |
| 搜索分词 | 🟡 | 中文分词未实现 |

### 4. API 完整性
| 问题 | 严重度 | 说明 |
|------|--------|------|
| 组织 API | 🟡 | `orgApi.list()` 等未完整对接 |
| 分享 API | 🟡 | 后端保存功能未完成 |
| 统计 API | 🟢 | 后端实现，前端未对接 |

### 5. 前端
| 问题 | 严重度 | 说明 |
|------|--------|------|
| 移动端优化 | 🟡 | 部分页面响应式有问题 |
| 暗色模式 | 🟢 | 未实现深色主题 |
| 加载状态 | 🟢 | 页面加载状态不完善 |

### 6. 测试覆盖
| 问题 | 严重度 | 说明 |
|------|--------|------|
| 覆盖率 | 🔴 | 当前覆盖率约 40% |
| 集成测试 | 🔴 | E2E 测试未开始 |
| Mock 服务 | 🟡 | 测试时缺少 mock 数据 |

---

## 🎯 接下来规划

### Phase 1: 核心完善 (1-2 周)

#### 1.1 数据库迁移
- [ ] 添加 Alembic 迁移工具
- [ ] 创建初始迁移脚本
- [ ] 添加必要索引

#### 1.2 认证增强
- [ ] 实现 Token 刷新机制
- [ ] 添加密码重置邮件
- [ ] 完善 API Key 管理

#### 1.3 API 完整性
- [ ] 完善组织管理 API
- [ ] 完善分享功能后端
- [ ] 对接统计 API

### Phase 2: 功能增强 (2-3 周)

#### 2.1 文档处理
- [ ] 实现 PDF OCR (pytesseract)
- [ ] 添加中文分词 (jieba)
- [ ] 实现增量索引

#### 2.2 知识图谱
- [ ] Neo4j 集成
- [ ] 图谱可视化优化
- [ ] 关系推理增强

#### 2.3 搜索增强
- [ ] 同义词扩展
- [ ] 相关搜索建议
- [ ] 搜索纠错

### Phase 3: 用户体验 (1-2 周)

#### 3.1 界面优化
- [ ] 完善响应式布局
- [ ] 深色模式
- [ ] 加载骨架屏

#### 3.2 性能优化
- [ ] 前端代码分割
- [ ] 图片懒加载
- [ ] 接口缓存优化

### Phase 4: 测试与质量 (1 周)

#### 4.1 测试覆盖
- [ ] 单元测试 > 80%
- [ ] 集成测试
- [ ] E2E 测试 (Playwright)

#### 4.2 CI/CD
- [ ] GitHub Actions 完善
- [ ] 自动发布 Docker Hub
- [ ] 版本发布流程

---

## 🚀 快速修复清单

### 立即可做 (1-3 小时)

1. **添加 .gitmodules 修复**
   ```bash
   rm backend/.gitmodules 2>/dev/null
   git add -A && git commit --amend -m "fix: 移除 gitmodules"
   git push -f origin main
   ```

2. **完善 API Key 后端存储**
   - 补全 `auth.py` 中 API Key 保存逻辑

3. **添加数据库索引**
   ```sql
   CREATE INDEX idx_documents_kb ON documents(kb_id);
   CREATE INDEX idx_chunks_doc ON document_chunks(doc_id);
   ```

### 本周可做 (1-3 天)

1. **实现 Token 刷新**
   - 添加 `POST /auth/refresh` 端点
   - 前端拦截 401 自动刷新

2. **完善组织 API**
   - 对接 `orgApi.list()`
   - 实现组织切换

3. **添加加载状态**
   - 全局加载组件
   - 页面骨架屏

### 长期规划

1. **多模态支持**
   - 图片内容提取
   - 音频转文字

2. **协作功能**
   - 实时协作编辑
   - 评论与讨论

3. **企业功能**
   - SSO 单点登录
   - 审计日志
   - 数据导出

4. **插件系统**
   - 第三方集成
   - 自定义处理器

---

## 📈 优先级排序

| 优先级 | 功能 | 原因 |
|--------|------|------|
| P0 | 数据库迁移 | 生产环境必备 |
| P0 | Token 刷新 | 安全必需 |
| P1 | PDF OCR | 常见需求 |
| P1 | 组织 API | 核心功能 |
| P2 | Neo4j 集成 | 高级功能 |
| P2 | 暗色模式 | 用户体验 |
| P3 | SSO | 企业需求 |

---

## 🔧 立即行动

```bash
# 1. 检查当前状态
cd litekb
git status

# 2. 查看待办
grep -r "TODO" --include="*.py" backend/ | head -20

# 3. 运行测试
cd backend
pytest tests/ -v --cov=app

# 4. 检查 API 完整性
grep -E "@app\.|@router\." app/main.py | wc -l
```

---

建议先从 **P0 优先级** 开始，数据库迁移和 Token 刷新是当前最关键的！
